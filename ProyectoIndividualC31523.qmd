---
title: "Poryecto_individual_CA0204_C31523"
author: "Olman Camacho"
date: "11-14-2025"
subtitle: "CA-0204 - Herramientas para Ciencias de Datos I"
titlepage: true
format:
  html:
    toc: true
    code-fold: true
    theme: cosmo
    toc-depth: 3
    smooth-scroll: true
editor: visual
---

=========
Librerias
=========

```{r}
library(tidyverse)
library(dplyr)
```

================
Importar dataset
================

```{r}
car_price_prediction_ <- read_csv("C:/Users/oecam/OneDrive/Desktop/UCR/Herramientas De Ciencias de Datos I/Trabajos/Proyecto-Individual-C31523/car_price_prediction_.csv")
head(car_price_prediction_)
```

================================
Verificación y limpieza de datos
================================

```{r}
## Verificar los datos faltantes en el dataset
colSums(is.na(car_price_prediction_))

## Por temas de simpleza, redondiemos los precios
car_price_prediction_$Price <- round(car_price_prediction_$Price, 0)
```

=====================
Graficos y Relaciones
=====================

Gráfico Brand-Model-Price
```{r}
ggplot(car_price_prediction_) +
  geom_boxplot(aes(x = Model, y = Price, fill = Brand), show.legend = FALSE) +
  facet_wrap(~ Brand, scales = "free_x") +
  scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
  labs(title = "Precio por Modelo dentro de cada Marca",
       x = "Modelo",
       y = "Precio")
```
Este gráfico interpreta cada precio en los modelos y grafica un boxplot que representa las posiciones relativas de dicha variable. La linea negra representa la mediana de los precios.

Gráfico Year-Brand-Price
```{r}
ggplot(car_price_prediction_, aes(x = Year, y = Price)) +
  geom_boxplot(fill = "#8da0cb", color = "black", aes(group = Year), outlier.size = 0.95, outlier.alpha = 0.78) +
  facet_wrap(~ Brand, scales = "free_y") +
  labs(title = "Distribución del precio de los autos por Año y Marca",
       x = "Año",
       y = "Precio") +
  scale_x_continuous(
    breaks = seq(min(car_price_prediction_$Year),
                 max(car_price_prediction_$Year),
                 by = 5)
  ) +
  scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE))
```
Este gráfico representa con respecto a las distintas marcas, y según el año de manufacturación del vehículo, la relación que tiene con el precio. Observamos ciertos valores atípicos en la muestra, que escapan del rango intercuartílico.

Gráfico Engine Size-Brand-Price
```{r}
for (b in unique(car_price_prediction_$Brand)) {
  
  data_b <- subset(car_price_prediction_, Brand == b)
  
  p <- ggplot(data_b, aes(x = `Engine Size`, y = Price)) +
    geom_boxplot(
      fill = "#8da0cb",
      color = "black",
      aes(group = `Engine Size`),
      outlier.size = 0.95,
      outlier.alpha = 0.78
    ) +
    labs(
      title = paste("Distribución del precio por Engine Size –", b),
      x = "Engine Size",
      y = "Precio"
    ) +
    scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE))
  
  print(p)
}
```


Gráfico Fuel-Brand-Price
```{r}
ggplot(car_price_prediction_) +
  geom_boxplot(aes(x = `Fuel Type`, y = Price, fill = Brand), show.legend = FALSE) +
  facet_wrap(~ Brand, scales = "free_y") +
  scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
  labs(title = "Precio por Tipo de Combustible dentro de cada Marca",
       x = "Tipo de Combustible",
       y = "Precio") 
```

Gráfico Transmission-Brand-Price
```{r}
ggplot(car_price_prediction_) +
  geom_boxplot(aes(x = Transmission, y = Price, fill = Brand), show.legend = FALSE) +
  facet_wrap(~ Brand, scales = "free_y") +
  scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
  labs(title = "Precio por Transmisión dentro de cada Marca",
       x = "Transmisión",
       y = "Precio")
```

Gráfico Mileage-Brand-Price
```{r}
for (b in unique(car_price_prediction_$Brand)) {
  
  data_b <- subset(car_price_prediction_, Brand == b)
  
  gráficos <- ggplot(data_b, aes(x = Mileage, y = Price)) +
    geom_point(alpha = 0.3, size = 1.8) + 
    geom_smooth(
      method = "loess",
      color = "black",
      fill = "#009E73",
      alpha = 0.35,
      linewidth = 1
    ) +
    labs(
      title = paste("Relación: Mileage vs Precio –", b),
      x = "Kilometraje",
      y = "Precio"
    ) +
    scale_y_continuous(
      labels = scales::comma_format(accuracy = 1)
    ) +
    scale_x_continuous(
      labels = scales::comma_format(accuracy = 1)
    )
  print(gráficos)
}
```

Gráfico Condition-Brand-Price
```{r}
ggplot(car_price_prediction_) +
  geom_boxplot(aes(x = Condition, y = Price, fill = Brand), show.legend = FALSE) +
  facet_wrap(~ Brand, scales = "free_y") +
  scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
  labs(title = "Precio por Condición dentro de cada Marca",
       x = "Condición",
       y = "Precio")
```
